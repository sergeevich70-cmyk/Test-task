1. Тест-кейс: Успешная оплата заказа с валидной картой (без 3-D Secure)
ID: TC_Integration with a payment gateway_01
Название: Успешная оплата заказа с валидной картой (без 3-D Secure)
Предусловия:

- Пользователь авторизован в системе.

- В корзине пользователя добавлен хотя бы один товар для оплаты.

- Тестовый стенд платежного шлюза сконфигурирован на возврат успешного ответа для тестовой карты.

Шаги выполнения:

- Открыть страницу оформления заказа / оплаты.

- В поле «Номер карты» ввести значение 4242 4242 4242 4242.

- В поле «Срок действия» ввести значение 12/25.

- В поле «CVV/CVC» ввести значение 123.

- Нажать кнопку «Оплатить».

Ожидаемый результат:

- Система отправляет данные в платежный шлюз.

- Пользователь видит индикатор загрузки (лоадер).

- После обработки платежа на странице отображается сообщение: «Оплата прошла успешно».

- Статус заказа в личном кабинете пользователя изменяется на «Оплачен».

- На электронную почту пользователя, указанную в профиле, приходит письмо с чеком об оплате.

2. Тест-кейс: Оплата отклонена банком-эмитентом
ID: TC_Integration with a payment gateway_02
Название: Оплата отклонена банком-эмитентом
Предусловия:

- Пользователь авторизован и находится на шаге оплаты заказа.

- Тестовый стенд платежного шлюза сконфигурирован на возврат ответа «Отклонено банком» для конкретной тестовой карты (например, 4000 0000 0000 0002).

Шаги выполнения:

- На странице оплаты ввести номер тестовой карты: 4000 0000 0000 0002.

- Заполнить поля «Срок действия» и «CVV» любыми валидными будущими значениями.

- Нажать кнопку «Оплатить».

Ожидаемый результат:

- Запрос уходит в платежный шлюз.

- Пользователь получает сообщение об ошибке: «Платеж отклонен банком. Пожалуйста, попробуйте использовать другую карту».

- Денежные средства с тестовой карты не списываются (проверяется по логам шлюза).

- Статус заказа в системе не изменяется и остается в значении «Ожидает оплаты».

- Письмо с чеком на email пользователя не отправляется.

3. Тест-кейс: Ошибка на стороне платежного шлюза (5xx)
ID: TC_Integration with a payment gateway_03
Название: Ошибка на стороне платежного шлюза (5xx)
Предусловия:

- Пользователь находится на странице оплаты заказа.

- Тестовый стенд платежного шлюза сконфигурирован на возврат HTTP-ошибки (например, 500 Internal Server Error) или длительный таймаут.

Шаги выполнения:

- Заполнить форму оплаты любыми валидными тестовыми данными карты.

- Нажать кнопку «Оплатить».

- Дождаться ответа от системы.

Ожидаемый результат:

- Система корректно обрабатывает ошибку сети/сервера.

- Пользователю отображается понятное сообщение: «Произошла техническая ошибка. Пожалуйста, повторите попытку позже или свяжитесь с поддержкой».

- Средства с карты не списаны (отсутствует запись об успешной транзакции в логах шлюза).

- Статус заказа не меняется на «Оплачен».

4. Тест-кейс: Прохождение 3-D Secure (Успех)
ID: TC_Integration with a payment gateway_04
Название: Интеграция с 3-D Secure: успешная аутентификация
Предусловия:

- Пользователь на странице оплаты.

- Используется тестовая карта, для которой настроено требование подтверждения по 3DS.

Шаги выполнения:

- Ввести данные тестовой карты (например, **номер_карты_для_3ds**).

- Нажать кнопку «Оплатить».

- Дождаться редиректа на страницу банка (эмулятор 3DS).

- На открывшейся странице ввести корректный код подтверждения (или нажать кнопку «Подтвердить»).

- Дождаться обратного редиректа на сайт магазина.

Ожидаемый результат:

- Пользователь возвращается на сайт интернет-магазина.

- Отображается сообщение об успешной оплате.

- Статус заказа меняется на «Оплачен».

5. Тест-кейс: Прохождение 3-D Secure (Отмена)
ID: TC_Integration with a payment gateway_05
Название: Интеграция с 3-D Secure: неуспешная аутентификация (отмена пользователем)
Предусловия:

- Пользователь на странице оплаты.

- Используется тестовая карта, требующая 3DS.

Шаги выполнения:

- Ввести данные карты и нажать «Оплатить».

- На странице 3DS-аутентификации нажать кнопку «Отмена» или «Назад».

- Дождаться возврата на сайт магазина.

Ожидаемый результат:

- Пользователь возвращается на сайт магазина.

- Платеж не проходит.

- Отображается сообщение: «3-D Secure аутентификация не пройдена» или «Платеж не завершен».

- Статус заказа остается без изменений («Ожидает оплаты»)
